!function(){"use strict";let e,t,n,r,s,a=[],i=-1,c=!1;function o(){e=document.getElementById("search-modal"),t=document.getElementById("search-input"),n=document.getElementById("search-results"),r=document.getElementById("search-trigger"),s=document.getElementById("search-close"),e&&t&&n&&(r.addEventListener("click",function(e){e.preventDefault(),l()}),s.addEventListener("click",d),e.addEventListener("click",function(t){t.target===e&&d()}),document.addEventListener("keydown",function(e){if("/"===e.key&&!u())return e.preventDefault(),void l();if("Escape"===e.key&&u())d();else if(u())if("ArrowDown"===e.key)e.preventDefault(),v(1);else if("ArrowUp"===e.key)e.preventDefault(),v(-1);else if("Enter"===e.key&&i>=0){e.preventDefault();const t=n.querySelectorAll(".search-result-item")[i];t&&(window.location.href=t.getAttribute("href"))}}),t.addEventListener("input",function(e,t){let n;return function(...r){const s=()=>{clearTimeout(n),e(...r)};clearTimeout(n),n=setTimeout(s,t)}}(f,200)))}function l(){e.classList.add("active"),e.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",h(),setTimeout(()=>t.focus(),100),c||function(){const t=e.getAttribute("data-search-source")||"/search.json";fetch(t).then(e=>e.json()).then(e=>{a=e,c=!0}).catch(e=>{console.error("Failed to load search data:",e),n.innerHTML='<div class="search-error">Failed to load search data</div>'})}()}function d(){e.classList.remove("active"),e.setAttribute("aria-hidden","true"),document.body.style.overflow="",t.value="",n.innerHTML="",i=-1}function u(){return e.classList.contains("active")}function f(){const r=t.value.trim().toLowerCase();if(!r)return void h();if(!c){const t=e.getAttribute("data-i18n-loading")||"Loading...";return void(n.innerHTML=`<div class="search-loading">${t}</div>`)}!function(t,r){if(i=-1,0===t.length){const t=e.getAttribute("data-i18n-no-results")||"No results found";return void(n.innerHTML=`<div class="search-no-results">${t}</div>`)}const s=t.slice(0,10).map((e,t)=>{const n=m(e.title,r),s=m(e.summary||e.content,r),a=e.categories[0]||"";return`\n        <a href="${e.url}" class="search-result-item" data-index="${t}" role="option">\n          <div class="search-result-content">\n            <div class="search-result-title">${n}</div>\n            <div class="search-result-summary">${s}</div>\n          </div>\n          <div class="search-result-meta">\n            ${a?`<span class="search-result-category">${a}</span>`:""}\n            <span class="search-result-date">${e.date}</span>\n          </div>\n        </a>\n      `}).join("");n.innerHTML=s,n.querySelectorAll(".search-result-item").forEach((e,t)=>{e.addEventListener("mouseenter",()=>{i=t,g()})})}((window.location.pathname.includes("/en/")?a.filter(e=>"en-US"===e.lang):a.filter(e=>"zh-CN"===e.lang)).filter(e=>e.title.toLowerCase().includes(r)||e.summary.toLowerCase().includes(r)||e.content.toLowerCase().includes(r)||e.categories.some(e=>e.toLowerCase().includes(r))),r)}function h(){const t=e.getAttribute("data-i18n-empty")||"Type to search articles...";n.innerHTML=`<div class="search-empty-state">${t}</div>`}function m(e,t){if(!e)return"";const n=new RegExp(`(${r=t,r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");var r;return e.replace(n,"<mark>$1</mark>")}function v(e){const t=n.querySelectorAll(".search-result-item");0!==t.length&&(i+=e,i<0?i=t.length-1:i>=t.length&&(i=0),g(),t[i].scrollIntoView({block:"nearest",behavior:"smooth"}))}function g(){n.querySelectorAll(".search-result-item").forEach((e,t)=>{t===i?(e.classList.add("selected"),e.setAttribute("aria-selected","true")):(e.classList.remove("selected"),e.setAttribute("aria-selected","false"))})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()}();